
<html>
    <head>
        <title>Coverage Report</title>
        
        <style type="text/css">
            body { background-color: #fff; }
            table {
                margin-left: 10px;
                border-collapse: collapse;
            }
            td { 
                background-color: #fff; 
                padding: 2px;
            }
            table.overview td {
                padding-right: 20px;
            }
            td.percent, td.linecount { text-align: right; }
            div.package, #totalcov { 
                color: #fff;
                background-color: #375eab; 
                font-size: 16px;
                font-weight: bold;
                padding: 10px;
                border-radius: 5px 5px 5px 5px;
            }
            div.package, #totalcov { 
                float: right; 
                right: 10px;
            }
            #totalcov { 
                top: 10px;
                position: relative;
                background-color: #fff;
                color: #000;
                border: 1px solid #375eab;
                clear: both;
            }
            #summaryWrapper {
                position: fixed;
                top: 10px;
                float: right;
                right: 10px;

            }
            span.packageTotal {
                float: right;
                color: #000;
            }
            #doctitle { 
                background-color: #fff; 
                font-size: 24px;
                margin-top: 20px;
                margin-left: 10px;
                color: #375eab;
                font-weight: bold;
            }
            #about {
                margin-left: 18px;
                font-size: 10px;
            }
            table tr:last-child td {
                font-weight: bold;
            }
            .functitle, .funcname { 
                text-align: center; 
                font-size: 20px; 
                font-weight: bold; 
                color: 375eab; 
            }
            .funcname {
                text-align: left;
                margin-top: 20px;
                margin-left: 10px;
                margin-bottom: 20px;
                padding: 2px 5px 5px;
                background-color: #e0ebf5;
            }
            table.listing {
                margin-left: 10px;
            }
            table.listing td {
                padding: 0px;
                font-size: 12px;
                background-color: #eee; 
                vertical-align: top;
                padding-left: 10px;
                border-bottom: 1px solid #fff;
            }
            table.listing td:first-child {
                text-align: right;
                font-weight: bold;
                vertical-align: center;
            }
            table.listing tr.miss td {
                background-color: #FFBBB8;
            }
            table.listing tr:last-child td {
                font-weight: normal;
                color: #000;
            }
            table.listing tr:last-child td:first-child {
                font-weight: bold;
            }
            .info {
                margin-left: 10px;
            }
            .info code {
            }
            pre { margin: 1px; }
            pre.cmd { 
                background-color: #e9e9e9;
                border-radius: 5px 5px 5px 5px;
                padding: 10px;
                margin: 20px;
                line-height: 18px;
                font-size; 14px;
            }
            a { 
                text-decoration: none; 
                color: #375eab;
            }
            a:hover { text-decoration: underline; }
            p { margin-left: 10px; }
        </style>
        
    </head>
    <body>
        <div id="doctitle">Coverage Report</div>
    <div id="about">Generated on 27 Sep 14 22:36 -0600 with <a href="https://github.com/matm/gocov-html">gocov-html</a></div><div id="pkg_gondalf" class="funcname">Package Overview: gondalf <span class="packageTotal">58.15%</span></div><p>This is a coverage report created after analysis of the <code>gondalf</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test gondalf | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_ValidateUniqueUsername"><td><code><a href="#fn_ValidateUniqueUsername">ValidateUniqueUsername(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_InitLogger"><td><code><a href="#fn_InitLogger">InitLogger(...)</a></code></td><td><code>gondalf/util.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_generateSessionToken"><td><code><a href="#fn_generateSessionToken">generateSessionToken(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_GetAppProperties"><td><code><a href="#fn_GetAppProperties">GetAppProperties(...)</a></code></td><td><code>gondalf/util.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_cleanUpAfterShutdown"><td><code><a href="#fn_cleanUpAfterShutdown">cleanUpAfterShutdown(...)</a></code></td><td><code>gondalf/server.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_GetDBConnection"><td><code><a href="#fn_GetDBConnection">GetDBConnection(...)</a></code></td><td><code>gondalf/db.go</code></td><td class="percent"><code>90.91%</code></td><td class="linecount"><code>10/11</code></td></tr>
<tr id="s_fn_CreateNewTokenDbEntry"><td><code><a href="#fn_CreateNewTokenDbEntry">CreateNewTokenDbEntry(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>90.00%</code></td><td class="linecount"><code>18/20</code></td></tr>
<tr id="s_fn_InsertAppProperties"><td><code><a href="#fn_InsertAppProperties">InsertAppProperties(...)</a></code></td><td><code>gondalf/db.go</code></td><td class="percent"><code>90.00%</code></td><td class="linecount"><code>9/10</code></td></tr>
<tr id="s_fn_CreateNewUser"><td><code><a href="#fn_CreateNewUser">CreateNewUser(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>88.89%</code></td><td class="linecount"><code>16/18</code></td></tr>
<tr id="s_fn_InsertDeviceTypes"><td><code><a href="#fn_InsertDeviceTypes">InsertDeviceTypes(...)</a></code></td><td><code>gondalf/db.go</code></td><td class="percent"><code>87.50%</code></td><td class="linecount"><code>7/8</code></td></tr>
<tr id="s_fn_AuthenticateUser"><td><code><a href="#fn_AuthenticateUser">AuthenticateUser(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>82.61%</code></td><td class="linecount"><code>19/23</code></td></tr>
<tr id="s_fn_ValidateSessionToken"><td><code><a href="#fn_ValidateSessionToken">ValidateSessionToken(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>82.35%</code></td><td class="linecount"><code>14/17</code></td></tr>
<tr id="s_fn_UpdatePasswordRecordLoginCount"><td><code><a href="#fn_UpdatePasswordRecordLoginCount">UpdatePasswordRecordLoginCount(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>77.78%</code></td><td class="linecount"><code>7/9</code></td></tr>
<tr id="s_fn_GetTimeOutValue"><td><code><a href="#fn_GetTimeOutValue">GetTimeOutValue(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>76.47%</code></td><td class="linecount"><code>13/17</code></td></tr>
<tr id="s_fn_EncryptPassword"><td><code><a href="#fn_EncryptPassword">EncryptPassword(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_ChangePassword"><td><code><a href="#fn_ChangePassword">ChangePassword(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>71.43%</code></td><td class="linecount"><code>15/21</code></td></tr>
<tr id="s_fn_GetConnectionProperties"><td><code><a href="#fn_GetConnectionProperties">GetConnectionProperties(...)</a></code></td><td><code>gondalf/db.go</code></td><td class="percent"><code>69.57%</code></td><td class="linecount"><code>16/23</code></td></tr>
<tr id="s_fn_InitApp"><td><code><a href="#fn_InitApp">InitApp(...)</a></code></td><td><code>gondalf/util.go</code></td><td class="percent"><code>62.50%</code></td><td class="linecount"><code>15/24</code></td></tr>
<tr id="s_fn_GetTimeExtension"><td><code><a href="#fn_GetTimeExtension">GetTimeExtension(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>55.56%</code></td><td class="linecount"><code>5/9</code></td></tr>
<tr id="s_fn_CheckPermissionsForUser"><td><code><a href="#fn_CheckPermissionsForUser">CheckPermissionsForUser(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/21</code></td></tr>
<tr id="s_fn_main"><td><code><a href="#fn_main">main(...)</a></code></td><td><code>gondalf/server.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/15</code></td></tr>
<tr id="s_fn_InitDB"><td><code><a href="#fn_InitDB">InitDB(...)</a></code></td><td><code>gondalf/db.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_ChangePasswordHandler"><td><code><a href="#fn_ChangePasswordHandler">ChangePasswordHandler(...)</a></code></td><td><code>gondalf/handlers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_LoginHandler"><td><code><a href="#fn_LoginHandler">LoginHandler(...)</a></code></td><td><code>gondalf/handlers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/10</code></td></tr>
<tr id="s_fn_CreateUserHandler"><td><code><a href="#fn_CreateUserHandler">CreateUserHandler(...)</a></code></td><td><code>gondalf/handlers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_CheckPermissionsForUserHandler"><td><code><a href="#fn_CheckPermissionsForUserHandler">CheckPermissionsForUserHandler(...)</a></code></td><td><code>gondalf/handlers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_ValidateSessionTokenHandler"><td><code><a href="#fn_ValidateSessionTokenHandler">ValidateSessionTokenHandler(...)</a></code></td><td><code>gondalf/handlers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_ValidateUsernameHandler"><td><code><a href="#fn_ValidateUsernameHandler">ValidateUsernameHandler(...)</a></code></td><td><code>gondalf/handlers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_Status"><td><code><a href="#fn_Status">Status(...)</a></code></td><td><code>gondalf/handlerUtils.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_StatusHandler"><td><code><a href="#fn_StatusHandler">StatusHandler(...)</a></code></td><td><code>gondalf/handlers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>gondalf</code></td><td class="percent"><code>58.15%</code></td><td class="linecount"><code>189/325</code></td></tr>
</table>

<div class="funcname" id="fn_ValidateUniqueUsername">func ValidateUniqueUsername</div><div class="info"><a href="#s_fn_ValidateUniqueUsername">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>161</td><td><code><pre>func ValidateUniqueUsername(username string, db *gorm.DB) bool {</pre></code></td></tr><tr><td>162</td><td><code><pre></pre></code></td></tr><tr><td>163</td><td><code><pre>        TRACE.Println(&#34;Validating username &#34; + username)</pre></code></td></tr><tr><td>164</td><td><code><pre>        err := db.Where(&amp;User{UserName: username}).First(&amp;User{}).Error</pre></code></td></tr><tr><td>165</td><td><code><pre></pre></code></td></tr><tr><td>166</td><td><code><pre>        if err == gorm.RecordNotFound {</pre></code></td></tr><tr><td>167</td><td><code><pre>                return true</pre></code></td></tr><tr><td>168</td><td><code><pre>        }</pre></code></td></tr><tr><td>169</td><td><code><pre>        WARNING.Println(&#34;Username &#34; + username + &#34; already present&#34;)</pre></code></td></tr><tr><td>170</td><td><code><pre>        return false</pre></code></td></tr><tr><td>171</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_InitLogger">func InitLogger</div><div class="info"><a href="#s_fn_InitLogger">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/util.go</code>:</p></div><table class="listing">
<tr><td>95</td><td><code><pre>func InitLogger(traceHandle io.Writer, infoHandle io.Writer, warningHandle io.Writer, errorHandle io.Writer, databaseHandle io.Writer) {</pre></code></td></tr><tr><td>96</td><td><code><pre></pre></code></td></tr><tr><td>97</td><td><code><pre>        TRACE = log.New(traceHandle, &#34;TRACE: &#34;, log.Ldate|log.Ltime|log.Lshortfile)</pre></code></td></tr><tr><td>98</td><td><code><pre></pre></code></td></tr><tr><td>99</td><td><code><pre>        INFO = log.New(infoHandle, &#34;INFO: &#34;, log.Ldate|log.Ltime|log.Lshortfile)</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>        WARNING = log.New(warningHandle, &#34;WARNING: &#34;, log.Ldate|log.Ltime|log.Lshortfile)</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr><td>103</td><td><code><pre>        ERROR = log.New(errorHandle, &#34;ERROR: &#34;, log.Ldate|log.Ltime|log.Lshortfile)</pre></code></td></tr><tr><td>104</td><td><code><pre></pre></code></td></tr><tr><td>105</td><td><code><pre>        DATABASE = log.New(databaseHandle, &#34;DATABASE: &#34;, log.Ldate|log.Ltime|log.Lshortfile)</pre></code></td></tr><tr><td>106</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateSessionToken">func generateSessionToken</div><div class="info"><a href="#s_fn_generateSessionToken">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>121</td><td><code><pre>func generateSessionToken(message string, key string) string {</pre></code></td></tr><tr><td>122</td><td><code><pre>        keyBytes := []byte(key)</pre></code></td></tr><tr><td>123</td><td><code><pre>        h := hmac.New(sha256.New, keyBytes)</pre></code></td></tr><tr><td>124</td><td><code><pre>        h.Write([]byte(message))</pre></code></td></tr><tr><td>125</td><td><code><pre>        return base64.StdEncoding.EncodeToString(h.Sum(nil))</pre></code></td></tr><tr><td>126</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetAppProperties">func GetAppProperties</div><div class="info"><a href="#s_fn_GetAppProperties">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/util.go</code>:</p></div><table class="listing">
<tr><td>108</td><td><code><pre>func GetAppProperties(propertyName string) (string, error) {</pre></code></td></tr><tr><td>109</td><td><code><pre>        for index := range properties {</pre></code></td></tr><tr><td>110</td><td><code><pre>                if properties[index].PropertyName == propertyName {</pre></code></td></tr><tr><td>111</td><td><code><pre>                        return properties[index].PropertyValue, nil</pre></code></td></tr><tr><td>112</td><td><code><pre>                }</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr><td>114</td><td><code><pre>        return &#34;&#34;, errors.New(&#34;App property &#34; + propertyName + &#34; not set&#34;)</pre></code></td></tr><tr><td>115</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_cleanUpAfterShutdown">func cleanUpAfterShutdown</div><div class="info"><a href="#s_fn_cleanUpAfterShutdown">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/server.go</code>:</p></div><table class="listing">
<tr><td>59</td><td><code><pre>func cleanUpAfterShutdown() {</pre></code></td></tr><tr><td>60</td><td><code><pre>        TRACE.Println(&#34;Cleaning up dbConnection and file stream&#34;)</pre></code></td></tr><tr><td>61</td><td><code><pre>        dbConnection.Close()</pre></code></td></tr><tr><td>62</td><td><code><pre>        file.Close()</pre></code></td></tr><tr><td>63</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetDBConnection">func GetDBConnection</div><div class="info"><a href="#s_fn_GetDBConnection">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/db.go</code>:</p></div><table class="listing">
<tr><td>70</td><td><code><pre>func GetDBConnection() gorm.DB {</pre></code></td></tr><tr><td>71</td><td><code><pre></pre></code></td></tr><tr><td>72</td><td><code><pre>        TRACE.Println(&#34;Connection properties will be read from &#34; + configFile)</pre></code></td></tr><tr><td>73</td><td><code><pre>        connParam := GetConnectionProperties(configFile)</pre></code></td></tr><tr><td>74</td><td><code><pre></pre></code></td></tr><tr><td>75</td><td><code><pre>        source := &#34;user=&#34; + connParam.username +</pre></code></td></tr><tr><td>76</td><td><code><pre>                &#34; password=&#34; + connParam.password +</pre></code></td></tr><tr><td>77</td><td><code><pre>                &#34; dbname=&#34; + connParam.dbname +</pre></code></td></tr><tr><td>78</td><td><code><pre>                &#34; port=&#34; + connParam.port +</pre></code></td></tr><tr><td>79</td><td><code><pre>                &#34; host=&#34; + connParam.host +</pre></code></td></tr><tr><td>80</td><td><code><pre>                &#34; sslmode=&#34; + connParam.sslmode</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>        db, err := gorm.Open(&#34;postgres&#34;, source)</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr><td>84</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>                ERROR.Panicln(&#34;Error opening DB connection&#34;)</pre></code></td></tr><tr><td>86</td><td><code><pre>        }</pre></code></td></tr><tr><td>87</td><td><code><pre></pre></code></td></tr><tr><td>88</td><td><code><pre>        TRACE.Println(&#34;DB Connection opened&#34;)</pre></code></td></tr><tr><td>89</td><td><code><pre></pre></code></td></tr><tr><td>90</td><td><code><pre>        db.DB().SetMaxIdleConns(10)</pre></code></td></tr><tr><td>91</td><td><code><pre>        db.DB().SetMaxOpenConns(100)</pre></code></td></tr><tr><td>92</td><td><code><pre>        db.DB().Ping()</pre></code></td></tr><tr><td>93</td><td><code><pre></pre></code></td></tr><tr><td>94</td><td><code><pre>        return db</pre></code></td></tr><tr><td>95</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_CreateNewTokenDbEntry">func CreateNewTokenDbEntry</div><div class="info"><a href="#s_fn_CreateNewTokenDbEntry">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>56</td><td><code><pre>func CreateNewTokenDbEntry(login LoginCredential, db *gorm.DB) (string, error) {</pre></code></td></tr><tr><td>57</td><td><code><pre>        user := User{}</pre></code></td></tr><tr><td>58</td><td><code><pre>        db.Where(&amp;User{UserName: login.Username}).Find(&amp;user)</pre></code></td></tr><tr><td>59</td><td><code><pre></pre></code></td></tr><tr><td>60</td><td><code><pre>        token := Token{}</pre></code></td></tr><tr><td>61</td><td><code><pre>        token.UserId = user.Id</pre></code></td></tr><tr><td>62</td><td><code><pre>        token.Key = uuid.New()</pre></code></td></tr><tr><td>63</td><td><code><pre>        token.CreatedAt = time.Now().UTC()</pre></code></td></tr><tr><td>64</td><td><code><pre>        token.LastAccessedAt = time.Now().UTC()</pre></code></td></tr><tr><td>65</td><td><code><pre>        token.Token = generateSessionToken(login.Username+token.CreatedAt.String(), token.Key)</pre></code></td></tr><tr><td>66</td><td><code><pre>        token.Active = true</pre></code></td></tr><tr><td>67</td><td><code><pre>        expiryTime, err := GetTimeOutValue(login.DeviceId)</pre></code></td></tr><tr><td>68</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>                ERROR.Println(err.Error())</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>                return &#34;&#34;, err</pre></code></td></tr><tr><td>71</td><td><code><pre>        }</pre></code></td></tr><tr><td>72</td><td><code><pre></pre></code></td></tr><tr><td>73</td><td><code><pre>        token.ExpiresAt = expiryTime</pre></code></td></tr><tr><td>74</td><td><code><pre></pre></code></td></tr><tr><td>75</td><td><code><pre>        var device DeviceType</pre></code></td></tr><tr><td>76</td><td><code><pre>        db.Where(&amp;DeviceType{DeviceCode: login.DeviceId}).Find(&amp;device)</pre></code></td></tr><tr><td>77</td><td><code><pre></pre></code></td></tr><tr><td>78</td><td><code><pre>        token.DeviceTypeId = device.Id</pre></code></td></tr><tr><td>79</td><td><code><pre></pre></code></td></tr><tr><td>80</td><td><code><pre>        db.Save(&amp;token)</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>        db.Save(&amp;ActivityLog{UserId: token.UserId, TokenId: token.Id, ActivityTime: time.Now().UTC(), Event: LOGIN})</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr><td>84</td><td><code><pre>        return token.Token, nil</pre></code></td></tr><tr><td>85</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_InsertAppProperties">func InsertAppProperties</div><div class="info"><a href="#s_fn_InsertAppProperties">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/db.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func InsertAppProperties(db *gorm.DB) bool {</pre></code></td></tr><tr><td>35</td><td><code><pre></pre></code></td></tr><tr><td>36</td><td><code><pre>        webTimeOut := AppProperties{PropertyName: &#34;WebTimeOut&#34;, PropertyValue: &#34;30&#34;, UpdatedAt: time.Now().UTC()}</pre></code></td></tr><tr><td>37</td><td><code><pre>        mobileTimeOut := AppProperties{PropertyName: &#34;MobileTimeOut&#34;, PropertyValue: &#34;720&#34;, UpdatedAt: time.Now().UTC()}</pre></code></td></tr><tr><td>38</td><td><code><pre>        dbDebugLogs := AppProperties{PropertyName: &#34;DbDebugLogs&#34;, PropertyValue: &#34;false&#34;, UpdatedAt: time.Now().UTC()}</pre></code></td></tr><tr><td>39</td><td><code><pre>        timeExtension := AppProperties{PropertyName: &#34;TimeExtension&#34;, PropertyValue: &#34;5&#34;, UpdatedAt: time.Now().UTC()}</pre></code></td></tr><tr><td>40</td><td><code><pre></pre></code></td></tr><tr><td>41</td><td><code><pre>        propertiesSlice := []AppProperties{webTimeOut, mobileTimeOut, dbDebugLogs, timeExtension}</pre></code></td></tr><tr><td>42</td><td><code><pre></pre></code></td></tr><tr><td>43</td><td><code><pre>        for i := range propertiesSlice {</pre></code></td></tr><tr><td>44</td><td><code><pre>                existsErr := db.Where(&amp;AppProperties{PropertyName: propertiesSlice[i].PropertyName}).Find(&amp;AppProperties{}).Error</pre></code></td></tr><tr><td>45</td><td><code><pre>                if existsErr == gorm.RecordNotFound {</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>                        db.Save(&amp;propertiesSlice[i])</pre></code></td></tr><tr><td>47</td><td><code><pre>                }</pre></code></td></tr><tr><td>48</td><td><code><pre>        }</pre></code></td></tr><tr><td>49</td><td><code><pre></pre></code></td></tr><tr><td>50</td><td><code><pre>        return true</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_CreateNewUser">func CreateNewUser</div><div class="info"><a href="#s_fn_CreateNewUser">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>128</td><td><code><pre>func CreateNewUser(request CreateUserRequest, db *gorm.DB) (int, error) {</pre></code></td></tr><tr><td>129</td><td><code><pre></pre></code></td></tr><tr><td>130</td><td><code><pre>        var err error</pre></code></td></tr><tr><td>131</td><td><code><pre></pre></code></td></tr><tr><td>132</td><td><code><pre>        if ValidateUniqueUsername(request.Username, db) {</pre></code></td></tr><tr><td>133</td><td><code><pre></pre></code></td></tr><tr><td>134</td><td><code><pre>                var user User</pre></code></td></tr><tr><td>135</td><td><code><pre></pre></code></td></tr><tr><td>136</td><td><code><pre>                user.UserName = request.Username</pre></code></td></tr><tr><td>137</td><td><code><pre>                user.LegalName = request.LegalName</pre></code></td></tr><tr><td>138</td><td><code><pre>                user.Password, err = EncryptPassword(request.Password)</pre></code></td></tr><tr><td>139</td><td><code><pre>                user.UpdatedAt = time.Now().UTC()</pre></code></td></tr><tr><td>140</td><td><code><pre>                user.Active = false</pre></code></td></tr><tr><td>141</td><td><code><pre></pre></code></td></tr><tr><td>142</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                        ERROR.Println(err.Error())</pre></code></td></tr><tr class="miss"><td>144</td><td><code><pre>                        return 500, EncryptionError</pre></code></td></tr><tr><td>145</td><td><code><pre>                }</pre></code></td></tr><tr><td>146</td><td><code><pre></pre></code></td></tr><tr><td>147</td><td><code><pre>                db.Save(&amp;user)</pre></code></td></tr><tr><td>148</td><td><code><pre>                TRACE.Println(&#34;New user created, userId: &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr><td>149</td><td><code><pre></pre></code></td></tr><tr><td>150</td><td><code><pre>                db.Save(&amp;PasswordRecord{UserId: user.Id, LoginCount: 0})</pre></code></td></tr><tr><td>151</td><td><code><pre>                TRACE.Println(&#34;New password record created, userId: &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr><td>152</td><td><code><pre></pre></code></td></tr><tr><td>153</td><td><code><pre>                return 200, nil</pre></code></td></tr><tr><td>154</td><td><code><pre>        }</pre></code></td></tr><tr><td>155</td><td><code><pre></pre></code></td></tr><tr><td>156</td><td><code><pre>        ERROR.Println(&#34;Duplicate username &#34; + request.Username + &#34; server validation in create user&#34;)</pre></code></td></tr><tr><td>157</td><td><code><pre>        return 409, errors.New(&#34;Duplicate username&#34;)</pre></code></td></tr><tr><td>158</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_InsertDeviceTypes">func InsertDeviceTypes</div><div class="info"><a href="#s_fn_InsertDeviceTypes">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/db.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func InsertDeviceTypes(db *gorm.DB) bool {</pre></code></td></tr><tr><td>54</td><td><code><pre>        webDevice := DeviceType{Device: &#34;web&#34;, DeviceCode: web}</pre></code></td></tr><tr><td>55</td><td><code><pre>        mobileDevice := DeviceType{Device: &#34;mobile&#34;, DeviceCode: mobile}</pre></code></td></tr><tr><td>56</td><td><code><pre></pre></code></td></tr><tr><td>57</td><td><code><pre>        devicesSlice := []DeviceType{webDevice, mobileDevice}</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>        for i := range devicesSlice {</pre></code></td></tr><tr><td>60</td><td><code><pre>                existsErr := db.Where(&amp;devicesSlice[i]).Find(&amp;DeviceType{}).Error</pre></code></td></tr><tr><td>61</td><td><code><pre>                if existsErr == gorm.RecordNotFound {</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                        db.Save(&amp;devicesSlice[i])</pre></code></td></tr><tr><td>63</td><td><code><pre>                }</pre></code></td></tr><tr><td>64</td><td><code><pre>        }</pre></code></td></tr><tr><td>65</td><td><code><pre></pre></code></td></tr><tr><td>66</td><td><code><pre>        return true</pre></code></td></tr><tr><td>67</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AuthenticateUser">func AuthenticateUser</div><div class="info"><a href="#s_fn_AuthenticateUser">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>17</td><td><code><pre>func AuthenticateUser(username string, password string, db *gorm.DB) error {</pre></code></td></tr><tr><td>18</td><td><code><pre>        var user User</pre></code></td></tr><tr><td>19</td><td><code><pre></pre></code></td></tr><tr><td>20</td><td><code><pre>        dbErr := db.Where(&amp;User{UserName: username}).Find(&amp;user).Error</pre></code></td></tr><tr><td>21</td><td><code><pre>        if dbErr != nil {</pre></code></td></tr><tr><td>22</td><td><code><pre>                if dbErr == gorm.RecordNotFound {</pre></code></td></tr><tr><td>23</td><td><code><pre>                        WARNING.Println(UnregisteredUser.Error() + &#34; ,username: &#34; + username)</pre></code></td></tr><tr><td>24</td><td><code><pre>                        return UnregisteredUser</pre></code></td></tr><tr><td>25</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                        ERROR.Println(dbErr.Error())</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                        return DatabaseError</pre></code></td></tr><tr><td>28</td><td><code><pre>                }</pre></code></td></tr><tr><td>29</td><td><code><pre>        }</pre></code></td></tr><tr><td>30</td><td><code><pre></pre></code></td></tr><tr><td>31</td><td><code><pre>        TRACE.Println(&#34;Login attempt by userId &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr><td>32</td><td><code><pre>        passwordCompareErr := bcrypt.CompareHashAndPassword([]byte(user.Password), []byte(password))</pre></code></td></tr><tr><td>33</td><td><code><pre>        if passwordCompareErr != nil {</pre></code></td></tr><tr><td>34</td><td><code><pre>                WARNING.Println(passwordCompareErr.Error() + &#34;, userId: &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr><td>35</td><td><code><pre>                return IncorrectPassword</pre></code></td></tr><tr><td>36</td><td><code><pre>        }</pre></code></td></tr><tr><td>37</td><td><code><pre></pre></code></td></tr><tr><td>38</td><td><code><pre>        var passwordRecord PasswordRecord</pre></code></td></tr><tr><td>39</td><td><code><pre></pre></code></td></tr><tr><td>40</td><td><code><pre>        dbPasswordRecordErr := db.Where(&amp;PasswordRecord{UserId: user.Id}).Find(&amp;passwordRecord).Error</pre></code></td></tr><tr><td>41</td><td><code><pre>        if dbPasswordRecordErr != nil {</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                ERROR.Println(dbPasswordRecordErr.Error() + &#34;, userId: &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>                return DatabaseError</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr><td>45</td><td><code><pre></pre></code></td></tr><tr><td>46</td><td><code><pre>        if dbPasswordRecordErr == nil &amp;&amp; passwordRecord.LoginCount == 0 {</pre></code></td></tr><tr><td>47</td><td><code><pre>                TRACE.Println(FirstLoginPasswordChange.Error() + &#34;, userId: &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr><td>48</td><td><code><pre>                return FirstLoginPasswordChange</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>        TRACE.Println(&#34;User authenticated, userId: &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr><td>52</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>53</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ValidateSessionToken">func ValidateSessionToken</div><div class="info"><a href="#s_fn_ValidateSessionToken">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>188</td><td><code><pre>func ValidateSessionToken(sessionToken string, db *gorm.DB) (error, int64) {</pre></code></td></tr><tr><td>189</td><td><code><pre>        var token Token</pre></code></td></tr><tr><td>190</td><td><code><pre></pre></code></td></tr><tr><td>191</td><td><code><pre>        dbErr := db.Where(&amp;Token{Token: sessionToken}).Find(&amp;token).Error</pre></code></td></tr><tr><td>192</td><td><code><pre>        if dbErr != nil {</pre></code></td></tr><tr><td>193</td><td><code><pre>                if dbErr == gorm.RecordNotFound {</pre></code></td></tr><tr><td>194</td><td><code><pre>                        WARNING.Println(InvalidSessionToken.Error() + &#34;, sessionToken: &#34; + sessionToken)</pre></code></td></tr><tr><td>195</td><td><code><pre>                        return InvalidSessionToken, -1</pre></code></td></tr><tr><td>196</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>197</td><td><code><pre>                ERROR.Println(dbErr.Error() + &#34;, sessionToken: &#34; + sessionToken)</pre></code></td></tr><tr class="miss"><td>198</td><td><code><pre>                return dbErr, -1</pre></code></td></tr><tr><td>199</td><td><code><pre>        }</pre></code></td></tr><tr><td>200</td><td><code><pre></pre></code></td></tr><tr><td>201</td><td><code><pre>        if token.Active &amp;&amp; token.ExpiresAt.After(time.Now().UTC()) {</pre></code></td></tr><tr><td>202</td><td><code><pre>                TRACE.Println(&#34;SessionToken validated: &#34; + sessionToken)</pre></code></td></tr><tr><td>203</td><td><code><pre>                timeLeft := token.ExpiresAt.Sub(time.Now().UTC())</pre></code></td></tr><tr><td>204</td><td><code><pre>                if timeLeft.Minutes() &lt; 5 {</pre></code></td></tr><tr class="miss"><td>205</td><td><code><pre>                        token.ExpiresAt = token.ExpiresAt.Add(time.Duration(GetTimeExtension()) * time.Minute)</pre></code></td></tr><tr><td>206</td><td><code><pre>                }</pre></code></td></tr><tr><td>207</td><td><code><pre>                token.LastAccessedAt = time.Now().UTC()</pre></code></td></tr><tr><td>208</td><td><code><pre>                db.Save(&amp;token)</pre></code></td></tr><tr><td>209</td><td><code><pre>                return nil, token.UserId</pre></code></td></tr><tr><td>210</td><td><code><pre>        }</pre></code></td></tr><tr><td>211</td><td><code><pre></pre></code></td></tr><tr><td>212</td><td><code><pre>        return ExpiredSessionToken, -1</pre></code></td></tr><tr><td>213</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_UpdatePasswordRecordLoginCount">func UpdatePasswordRecordLoginCount</div><div class="info"><a href="#s_fn_UpdatePasswordRecordLoginCount">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>268</td><td><code><pre>func UpdatePasswordRecordLoginCount(userid int64, resetFlag bool, db *gorm.DB) error {</pre></code></td></tr><tr><td>269</td><td><code><pre>        var record PasswordRecord</pre></code></td></tr><tr><td>270</td><td><code><pre>        dbErr := db.Where(&amp;PasswordRecord{UserId: userid}).Find(&amp;record).Error</pre></code></td></tr><tr><td>271</td><td><code><pre>        if dbErr != nil {</pre></code></td></tr><tr class="miss"><td>272</td><td><code><pre>                return dbErr</pre></code></td></tr><tr><td>273</td><td><code><pre>        }</pre></code></td></tr><tr><td>274</td><td><code><pre></pre></code></td></tr><tr><td>275</td><td><code><pre>        if resetFlag {</pre></code></td></tr><tr class="miss"><td>276</td><td><code><pre>                record.LoginCount = 0</pre></code></td></tr><tr><td>277</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>278</td><td><code><pre>                record.LoginCount++</pre></code></td></tr><tr><td>279</td><td><code><pre>        }</pre></code></td></tr><tr><td>280</td><td><code><pre></pre></code></td></tr><tr><td>281</td><td><code><pre>        db.Save(&amp;record)</pre></code></td></tr><tr><td>282</td><td><code><pre>        </pre></code></td></tr><tr><td>283</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>284</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetTimeOutValue">func GetTimeOutValue</div><div class="info"><a href="#s_fn_GetTimeOutValue">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>88</td><td><code><pre>func GetTimeOutValue(deviceId int) (time.Time, error) {</pre></code></td></tr><tr><td>89</td><td><code><pre></pre></code></td></tr><tr><td>90</td><td><code><pre>        var propName string</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr><td>92</td><td><code><pre>        if deviceId == web {</pre></code></td></tr><tr><td>93</td><td><code><pre>                propName = &#34;WebTimeOut&#34;</pre></code></td></tr><tr><td>94</td><td><code><pre>        } else if deviceId == mobile {</pre></code></td></tr><tr><td>95</td><td><code><pre>                propName = &#34;MobileTimeOut&#34;</pre></code></td></tr><tr><td>96</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>97</td><td><code><pre>                ERROR.Println(&#34;Invalid deviceId&#34;)</pre></code></td></tr><tr><td>98</td><td><code><pre>                return time.Time{}, errors.New(&#34;Invalid device&#34;)</pre></code></td></tr><tr><td>99</td><td><code><pre>        }</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>        timeOutString, err := GetAppProperties(propName)</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr><td>103</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>                ERROR.Println(err.Error())</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>                return time.Time{}, err</pre></code></td></tr><tr><td>106</td><td><code><pre>        }</pre></code></td></tr><tr><td>107</td><td><code><pre></pre></code></td></tr><tr><td>108</td><td><code><pre>        timeOutValue, err := strconv.Atoi(timeOutString)</pre></code></td></tr><tr><td>109</td><td><code><pre></pre></code></td></tr><tr><td>110</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>                ERROR.Println(&#34;String to integer conversion failed for &#34; + propName)</pre></code></td></tr><tr class="miss"><td>112</td><td><code><pre>                return time.Time{}, err</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr><td>114</td><td><code><pre></pre></code></td></tr><tr><td>115</td><td><code><pre>        expiryTime := time.Now().UTC().Add(time.Duration(timeOutValue) * time.Minute)</pre></code></td></tr><tr><td>116</td><td><code><pre></pre></code></td></tr><tr><td>117</td><td><code><pre>        return expiryTime, nil</pre></code></td></tr><tr><td>118</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_EncryptPassword">func EncryptPassword</div><div class="info"><a href="#s_fn_EncryptPassword">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>173</td><td><code><pre>func EncryptPassword(password string) (string, error) {</pre></code></td></tr><tr><td>174</td><td><code><pre></pre></code></td></tr><tr><td>175</td><td><code><pre>        encryptedPasswordBytes, err := bcrypt.GenerateFromPassword([]byte(password), bcrypt.DefaultCost)</pre></code></td></tr><tr><td>176</td><td><code><pre></pre></code></td></tr><tr><td>177</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>178</td><td><code><pre>                return &#34;&#34;, err</pre></code></td></tr><tr><td>179</td><td><code><pre>        }</pre></code></td></tr><tr><td>180</td><td><code><pre></pre></code></td></tr><tr><td>181</td><td><code><pre>        return string(encryptedPasswordBytes), nil</pre></code></td></tr><tr><td>182</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ChangePassword">func ChangePassword</div><div class="info"><a href="#s_fn_ChangePassword">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>232</td><td><code><pre>func ChangePassword(username string, newpassword string, db *gorm.DB) (int, error) {</pre></code></td></tr><tr><td>233</td><td><code><pre>        var user User</pre></code></td></tr><tr><td>234</td><td><code><pre>        var err error</pre></code></td></tr><tr><td>235</td><td><code><pre></pre></code></td></tr><tr><td>236</td><td><code><pre>        dbErr := db.Where(&amp;User{UserName: username}).Find(&amp;user).Error</pre></code></td></tr><tr><td>237</td><td><code><pre>        if dbErr != nil {</pre></code></td></tr><tr><td>238</td><td><code><pre>                if dbErr == gorm.RecordNotFound {</pre></code></td></tr><tr><td>239</td><td><code><pre>                        WARNING.Println(UnregisteredUser.Error() + &#34; ,username: &#34; + username)</pre></code></td></tr><tr><td>240</td><td><code><pre>                        return 401, UnregisteredUser</pre></code></td></tr><tr><td>241</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>242</td><td><code><pre>                        ERROR.Println(dbErr.Error())</pre></code></td></tr><tr class="miss"><td>243</td><td><code><pre>                        return 500, DatabaseError</pre></code></td></tr><tr><td>244</td><td><code><pre>                }</pre></code></td></tr><tr><td>245</td><td><code><pre>        }</pre></code></td></tr><tr><td>246</td><td><code><pre></pre></code></td></tr><tr><td>247</td><td><code><pre>        user.Password, err = EncryptPassword(newpassword)</pre></code></td></tr><tr><td>248</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>249</td><td><code><pre>                ERROR.Println(err.Error())</pre></code></td></tr><tr class="miss"><td>250</td><td><code><pre>                return 500, EncryptionError</pre></code></td></tr><tr><td>251</td><td><code><pre>        }</pre></code></td></tr><tr><td>252</td><td><code><pre></pre></code></td></tr><tr><td>253</td><td><code><pre>        db.Save(&amp;user)</pre></code></td></tr><tr><td>254</td><td><code><pre>        updatePasswordErr := UpdatePasswordRecordLoginCount(user.Id, false, db)</pre></code></td></tr><tr><td>255</td><td><code><pre></pre></code></td></tr><tr><td>256</td><td><code><pre>        if updatePasswordErr != nil {</pre></code></td></tr><tr class="miss"><td>257</td><td><code><pre>                ERROR.Println(&#34;Password record not updated for userId: &#34; + strconv.FormatInt(user.Id, 10) + &#34;, Error details: &#34; + updatePasswordErr.Error())</pre></code></td></tr><tr class="miss"><td>258</td><td><code><pre>                return 500, DatabaseError</pre></code></td></tr><tr><td>259</td><td><code><pre>        }</pre></code></td></tr><tr><td>260</td><td><code><pre></pre></code></td></tr><tr><td>261</td><td><code><pre>        db.Save(&amp;ActivityLog{UserId: user.Id, TokenId: -1, ActivityTime: time.Now().UTC(), Event: PASSWORD_CHANGE})</pre></code></td></tr><tr><td>262</td><td><code><pre>        TRACE.Println(&#34;Password changed for userId: &#34; + strconv.FormatInt(user.Id, 10))</pre></code></td></tr><tr><td>263</td><td><code><pre></pre></code></td></tr><tr><td>264</td><td><code><pre>        return 200, nil</pre></code></td></tr><tr><td>265</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetConnectionProperties">func GetConnectionProperties</div><div class="info"><a href="#s_fn_GetConnectionProperties">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/db.go</code>:</p></div><table class="listing">
<tr><td>98</td><td><code><pre>func GetConnectionProperties(filename string) ConnectionParameters {</pre></code></td></tr><tr><td>99</td><td><code><pre></pre></code></td></tr><tr><td>100</td><td><code><pre>        var conParam ConnectionParameters</pre></code></td></tr><tr><td>101</td><td><code><pre></pre></code></td></tr><tr><td>102</td><td><code><pre>        c, err := conf.ReadFile(filename)</pre></code></td></tr><tr><td>103</td><td><code><pre></pre></code></td></tr><tr><td>104</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>                ERROR.Panicln(err)</pre></code></td></tr><tr><td>106</td><td><code><pre>        }</pre></code></td></tr><tr><td>107</td><td><code><pre></pre></code></td></tr><tr><td>108</td><td><code><pre>        conParam.username, err = c.String(&#34;default&#34;, &#34;username&#34;)</pre></code></td></tr><tr><td>109</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>110</td><td><code><pre>                ERROR.Panicln(err)</pre></code></td></tr><tr><td>111</td><td><code><pre>        }</pre></code></td></tr><tr><td>112</td><td><code><pre></pre></code></td></tr><tr><td>113</td><td><code><pre>        conParam.password, err = c.String(&#34;default&#34;, &#34;password&#34;)</pre></code></td></tr><tr><td>114</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>                ERROR.Panicln(err)</pre></code></td></tr><tr><td>116</td><td><code><pre>        }</pre></code></td></tr><tr><td>117</td><td><code><pre></pre></code></td></tr><tr><td>118</td><td><code><pre>        conParam.host, err = c.String(&#34;default&#34;, &#34;host&#34;)</pre></code></td></tr><tr><td>119</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>120</td><td><code><pre>                ERROR.Panicln(err)</pre></code></td></tr><tr><td>121</td><td><code><pre>        }</pre></code></td></tr><tr><td>122</td><td><code><pre></pre></code></td></tr><tr><td>123</td><td><code><pre>        conParam.port, err = c.String(&#34;default&#34;, &#34;port&#34;)</pre></code></td></tr><tr><td>124</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>125</td><td><code><pre>                ERROR.Panicln(err)</pre></code></td></tr><tr><td>126</td><td><code><pre>        }</pre></code></td></tr><tr><td>127</td><td><code><pre></pre></code></td></tr><tr><td>128</td><td><code><pre>        conParam.dbname, err = c.String(&#34;default&#34;, &#34;dbname&#34;)</pre></code></td></tr><tr><td>129</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>130</td><td><code><pre>                ERROR.Panicln(err)</pre></code></td></tr><tr><td>131</td><td><code><pre>        }</pre></code></td></tr><tr><td>132</td><td><code><pre></pre></code></td></tr><tr><td>133</td><td><code><pre>        conParam.sslmode, err = c.String(&#34;default&#34;, &#34;sslmode&#34;)</pre></code></td></tr><tr><td>134</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>135</td><td><code><pre>                ERROR.Panicln(err)</pre></code></td></tr><tr><td>136</td><td><code><pre>        }</pre></code></td></tr><tr><td>137</td><td><code><pre></pre></code></td></tr><tr><td>138</td><td><code><pre>        return conParam</pre></code></td></tr><tr><td>139</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_InitApp">func InitApp</div><div class="info"><a href="#s_fn_InitApp">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/util.go</code>:</p></div><table class="listing">
<tr><td>56</td><td><code><pre>func InitApp(logFileName string, initializeDB *bool) {</pre></code></td></tr><tr><td>57</td><td><code><pre>        var err error</pre></code></td></tr><tr><td>58</td><td><code><pre>        file, err = os.OpenFile(logFileName, os.O_CREATE|os.O_RDWR|os.O_APPEND, 0666)</pre></code></td></tr><tr><td>59</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>                fmt.Println(&#34;Log file cannot be opened&#34;)</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                file.Close()</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                file = os.Stdout</pre></code></td></tr><tr><td>63</td><td><code><pre>        }</pre></code></td></tr><tr><td>64</td><td><code><pre></pre></code></td></tr><tr><td>65</td><td><code><pre>        InitLogger(file, file, file, file, file)</pre></code></td></tr><tr><td>66</td><td><code><pre>        TRACE.Println(&#34;Logger initialized to file &#34; + logFileName)</pre></code></td></tr><tr><td>67</td><td><code><pre></pre></code></td></tr><tr><td>68</td><td><code><pre>        dbConnection = GetDBConnection()</pre></code></td></tr><tr><td>69</td><td><code><pre>        TRACE.Println(&#34;Global connection object initialized&#34;)</pre></code></td></tr><tr><td>70</td><td><code><pre></pre></code></td></tr><tr><td>71</td><td><code><pre>        TRACE.Println(string(strconv.AppendBool([]byte(&#34;Application started with Init DB flag value &#34;), *initializeDB)))</pre></code></td></tr><tr><td>72</td><td><code><pre></pre></code></td></tr><tr><td>73</td><td><code><pre>        if *initializeDB == true {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                TRACE.Println(&#34;DB Init Start&#34;)</pre></code></td></tr><tr class="miss"><td>75</td><td><code><pre>                InitDB()</pre></code></td></tr><tr class="miss"><td>76</td><td><code><pre>                TRACE.Println(&#34;DB Init Complete&#34;)</pre></code></td></tr><tr><td>77</td><td><code><pre>        }</pre></code></td></tr><tr><td>78</td><td><code><pre></pre></code></td></tr><tr><td>79</td><td><code><pre>        dbConnection.Find(&amp;properties)</pre></code></td></tr><tr><td>80</td><td><code><pre>        TRACE.Println(&#34;App properties array initialized&#34;)</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>        dbLoggerPropertyValue, err := GetAppProperties(&#34;DbDebugLogs&#34;)</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr><td>84</td><td><code><pre>        if err == nil {</pre></code></td></tr><tr><td>85</td><td><code><pre>                dbLoggerFlag, err := strconv.ParseBool(dbLoggerPropertyValue)</pre></code></td></tr><tr><td>86</td><td><code><pre>                if err == nil &amp;&amp; dbLoggerFlag {</pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>                        dbConnection.LogMode(dbLoggerFlag)</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>                        dbConnection.SetLogger(DATABASE)</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                        TRACE.Println(&#34;Database logger initialized&#34;)</pre></code></td></tr><tr><td>90</td><td><code><pre>                }</pre></code></td></tr><tr><td>91</td><td><code><pre>        }</pre></code></td></tr><tr><td>92</td><td><code><pre></pre></code></td></tr><tr><td>93</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetTimeExtension">func GetTimeExtension</div><div class="info"><a href="#s_fn_GetTimeExtension">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>215</td><td><code><pre>func GetTimeExtension() int {</pre></code></td></tr><tr><td>216</td><td><code><pre></pre></code></td></tr><tr><td>217</td><td><code><pre>        timeExtensionString, err := GetAppProperties(&#34;TimeExtension&#34;)</pre></code></td></tr><tr><td>218</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>219</td><td><code><pre>                ERROR.Println(err.Error())</pre></code></td></tr><tr class="miss"><td>220</td><td><code><pre>                return 0</pre></code></td></tr><tr><td>221</td><td><code><pre>        }</pre></code></td></tr><tr><td>222</td><td><code><pre></pre></code></td></tr><tr><td>223</td><td><code><pre>        extension, conversionErr := strconv.Atoi(timeExtensionString)</pre></code></td></tr><tr><td>224</td><td><code><pre>        if conversionErr != nil {</pre></code></td></tr><tr class="miss"><td>225</td><td><code><pre>                ERROR.Println(conversionErr.Error())</pre></code></td></tr><tr class="miss"><td>226</td><td><code><pre>                return 0</pre></code></td></tr><tr><td>227</td><td><code><pre>        }</pre></code></td></tr><tr><td>228</td><td><code><pre></pre></code></td></tr><tr><td>229</td><td><code><pre>        return extension</pre></code></td></tr><tr><td>230</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_CheckPermissionsForUser">func CheckPermissionsForUser</div><div class="info"><a href="#s_fn_CheckPermissionsForUser">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>288</td><td><code><pre>func CheckPermissionsForUser(userid int64, permission Permission, db *gorm.DB) error {</pre></code></td></tr><tr class="miss"><td>289</td><td><code><pre>        if userid == int64(-1) {</pre></code></td></tr><tr class="miss"><td>290</td><td><code><pre>                return PermissionDenied</pre></code></td></tr><tr><td>291</td><td><code><pre>        }</pre></code></td></tr><tr><td>292</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>293</td><td><code><pre>        err := db.Where(&amp;Permission{PermissionDescription: permission.PermissionDescription}).Find(&amp;permission).Error</pre></code></td></tr><tr class="miss"><td>294</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>295</td><td><code><pre>                ERROR.Println(err.Error() + &#34; while checking permission for: &#34; + permission.PermissionDescription)</pre></code></td></tr><tr class="miss"><td>296</td><td><code><pre>                return err</pre></code></td></tr><tr><td>297</td><td><code><pre>        }</pre></code></td></tr><tr><td>298</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>299</td><td><code><pre>        var groupPermission GroupPermission</pre></code></td></tr><tr class="miss"><td>300</td><td><code><pre>        err = db.Where(&amp;GroupPermission{PermissionId: permission.Id}).Find(&amp;groupPermission).Error</pre></code></td></tr><tr class="miss"><td>301</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>302</td><td><code><pre>                ERROR.Println(err.Error() + &#34; while finding groupPermission for: &#34; + strconv.FormatInt(permission.Id, 10))</pre></code></td></tr><tr class="miss"><td>303</td><td><code><pre>                return err</pre></code></td></tr><tr><td>304</td><td><code><pre>        }</pre></code></td></tr><tr><td>305</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>306</td><td><code><pre>        var userGroup UserGroup</pre></code></td></tr><tr class="miss"><td>307</td><td><code><pre>        err = db.Where(&amp;UserGroup{UserId: userid, GroupId: groupPermission.GroupId}).Find(&amp;userGroup).Error</pre></code></td></tr><tr class="miss"><td>308</td><td><code><pre>        if err == gorm.RecordNotFound {</pre></code></td></tr><tr class="miss"><td>309</td><td><code><pre>                WARNING.Println(PermissionDenied.Error() + &#34; for user: &#34; + strconv.FormatInt(userid, 10) +</pre></code></td></tr><tr><td>310</td><td><code><pre>                        &#34; for Permission: &#34; + permission.PermissionDescription)</pre></code></td></tr><tr class="miss"><td>311</td><td><code><pre>                return PermissionDenied</pre></code></td></tr><tr class="miss"><td>312</td><td><code><pre>        } else if err != nil {</pre></code></td></tr><tr class="miss"><td>313</td><td><code><pre>                ERROR.Println(err.Error() + &#34; in UserGroup while searching for userId: &#34; + strconv.FormatInt(userid, 10) +</pre></code></td></tr><tr><td>314</td><td><code><pre>                        &#34; and groupId: &#34; + strconv.FormatInt(groupPermission.GroupId, 10))</pre></code></td></tr><tr class="miss"><td>315</td><td><code><pre>                return err</pre></code></td></tr><tr><td>316</td><td><code><pre>        }</pre></code></td></tr><tr><td>317</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>318</td><td><code><pre>        TRACE.Println(&#34;Permission verified for userId: &#34; + strconv.FormatInt(userid, 10) + &#34; , permission: &#34; + permission.PermissionDescription)</pre></code></td></tr><tr class="miss"><td>319</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>320</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_main">func main</div><div class="info"><a href="#s_fn_main">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/server.go</code>:</p></div><table class="listing">
<tr><td>24</td><td><code><pre>func main() {</pre></code></td></tr><tr><td>25</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>        initializeDB := flag.Bool(&#34;initdb&#34;, false, &#34;initalizing database&#34;)</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>        flag.Parse()</pre></code></td></tr><tr><td>28</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>        InitApp(logFile, initializeDB)</pre></code></td></tr><tr><td>30</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>        m := martini.Classic()</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>        m.Use(render.Renderer())</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>        m.Use(martini.Recovery())</pre></code></td></tr><tr><td>34</td><td><code><pre></pre></code></td></tr><tr><td>35</td><td><code><pre>        //status</pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>        m.Get(&#34;/status&#34;, StatusHandler)</pre></code></td></tr><tr><td>37</td><td><code><pre></pre></code></td></tr><tr><td>38</td><td><code><pre>        //Login end point</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>        m.Post(&#34;/auth/login&#34;, binding.Bind(LoginCredential{}), LoginHandler)</pre></code></td></tr><tr><td>40</td><td><code><pre></pre></code></td></tr><tr><td>41</td><td><code><pre>        //Create new user</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>        m.Post(&#34;/user/create&#34;, binding.Bind(CreateUserRequest{}), CreateUserHandler)</pre></code></td></tr><tr><td>43</td><td><code><pre></pre></code></td></tr><tr><td>44</td><td><code><pre>        //Validate unique username</pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>        m.Post(&#34;/validate/username&#34;, binding.Bind(ValidateUsernameRequest{}), ValidateUsernameHandler)</pre></code></td></tr><tr><td>46</td><td><code><pre></pre></code></td></tr><tr><td>47</td><td><code><pre>        //Validate session token</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>        m.Post(&#34;/validate/token&#34;, binding.Bind(ValidateUsernameRequest{}), ValidateSessionTokenHandler)</pre></code></td></tr><tr><td>49</td><td><code><pre></pre></code></td></tr><tr><td>50</td><td><code><pre>        //Change password</pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>        m.Post(&#34;/user/changePassword&#34;, binding.Bind(ChangePasswordRequest{}), ChangePasswordHandler)</pre></code></td></tr><tr><td>52</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>        graceful.Run(&#34;:3000&#34;, 10*time.Second, m)</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>55</td><td><code><pre>        TRACE.Println(&#34;DB connection closed&#34;)</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>        defer cleanUpAfterShutdown()</pre></code></td></tr><tr><td>57</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_InitDB">func InitDB</div><div class="info"><a href="#s_fn_InitDB">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/db.go</code>:</p></div><table class="listing">
<tr><td>15</td><td><code><pre>func InitDB() {</pre></code></td></tr><tr><td>16</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>17</td><td><code><pre>        dbConnection.AutoMigrate(User{})</pre></code></td></tr><tr class="miss"><td>18</td><td><code><pre>        dbConnection.AutoMigrate(Permission{})</pre></code></td></tr><tr class="miss"><td>19</td><td><code><pre>        dbConnection.AutoMigrate(Group{})</pre></code></td></tr><tr class="miss"><td>20</td><td><code><pre>        dbConnection.AutoMigrate(GroupPermission{})</pre></code></td></tr><tr class="miss"><td>21</td><td><code><pre>        dbConnection.AutoMigrate(UserGroup{})</pre></code></td></tr><tr><td>22</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>23</td><td><code><pre>        dbConnection.AutoMigrate(AppProperties{})</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>        dbConnection.AutoMigrate(ActivityLog{})</pre></code></td></tr><tr><td>25</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>        dbConnection.AutoMigrate(Token{})</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>        dbConnection.AutoMigrate(DeviceType{})</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>        dbConnection.AutoMigrate(PasswordRecord{})</pre></code></td></tr><tr><td>29</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>30</td><td><code><pre>        InsertAppProperties(&amp;dbConnection)</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>        InsertDeviceTypes(&amp;dbConnection)</pre></code></td></tr><tr><td>32</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ChangePasswordHandler">func ChangePasswordHandler</div><div class="info"><a href="#s_fn_ChangePasswordHandler">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlers.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func ChangePasswordHandler(request ChangePasswordRequest, r render.Render) {</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>55</td><td><code><pre>        authenticateUserError := AuthenticateUser(request.Username, request.OldPassword, &amp;dbConnection)</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>        if authenticateUserError == nil || authenticateUserError == FirstLoginPasswordChange {</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>                status, changePasswordError := ChangePassword(request.Username, request.NewPassword, &amp;dbConnection)</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                if changePasswordError == nil {</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>                        login := LoginCredential{Username: request.Username, Password: request.NewPassword, DeviceId: request.DeviceId}</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>                        sessionToken, err := CreateNewTokenDbEntry(login, &amp;dbConnection)</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                                ERROR.Println(&#34;DB entry failed for token, returning 500&#34;)</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                                r.JSON(500, map[string]interface{}{&#34;passwordChanged&#34;: true, &#34;sessionToken&#34;: &#34;&#34;, &#34;error&#34;: err.Error()})</pre></code></td></tr><tr><td>64</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>                        r.JSON(200, map[string]interface{}{&#34;passwordChanged&#34;: true, &#34;sessionToken&#34;: sessionToken, &#34;error&#34;: nil})</pre></code></td></tr><tr><td>66</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                r.JSON(status, map[string]interface{}{&#34;passwordChanged&#34;: false})</pre></code></td></tr><tr><td>68</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>        r.JSON(401, AuthenticationFailed.Error())</pre></code></td></tr><tr><td>70</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LoginHandler">func LoginHandler</div><div class="info"><a href="#s_fn_LoginHandler">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlers.go</code>:</p></div><table class="listing">
<tr><td>15</td><td><code><pre>func LoginHandler(login LoginCredential, r render.Render) {</pre></code></td></tr><tr><td>16</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>17</td><td><code><pre>        authenticateUserErr := AuthenticateUser(login.Username, login.Password, &amp;dbConnection)</pre></code></td></tr><tr><td>18</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>19</td><td><code><pre>        if authenticateUserErr == nil {</pre></code></td></tr><tr class="miss"><td>20</td><td><code><pre>                sessionToken, err := CreateNewTokenDbEntry(login, &amp;dbConnection)</pre></code></td></tr><tr class="miss"><td>21</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>22</td><td><code><pre>                        ERROR.Println(&#34;DB entry failed for token, returning 500&#34;)</pre></code></td></tr><tr class="miss"><td>23</td><td><code><pre>                        r.JSON(500, &#34;Ughh, something wrong with the server&#34;)</pre></code></td></tr><tr><td>24</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>                        r.JSON(200, map[string]interface{}{&#34;sessionToken&#34;: sessionToken, &#34;error&#34;: nil})</pre></code></td></tr><tr><td>26</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>        } else if authenticateUserErr == FirstLoginPasswordChange {</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                r.JSON(200, map[string]interface{}{&#34;sessionToken&#34;: &#34;&#34;, &#34;error&#34;: FirstLoginPasswordChange.Error()})</pre></code></td></tr><tr><td>29</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>30</td><td><code><pre>                r.JSON(401, AuthenticationFailed.Error())</pre></code></td></tr><tr><td>31</td><td><code><pre>        }</pre></code></td></tr><tr><td>32</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_CreateUserHandler">func CreateUserHandler</div><div class="info"><a href="#s_fn_CreateUserHandler">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlers.go</code>:</p></div><table class="listing">
<tr><td>41</td><td><code><pre>func CreateUserHandler(request CreateUserRequest, r render.Render) {</pre></code></td></tr><tr><td>42</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>        status, err := CreateNewUser(request, &amp;dbConnection)</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>                ERROR.Println(err.Error())</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                r.JSON(status, map[string]interface{}{&#34;userCreated&#34;: false})</pre></code></td></tr><tr><td>48</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>49</td><td><code><pre>                r.JSON(status, map[string]interface{}{&#34;userCreated&#34;: true})</pre></code></td></tr><tr><td>50</td><td><code><pre>        }</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_CheckPermissionsForUserHandler">func CheckPermissionsForUserHandler</div><div class="info"><a href="#s_fn_CheckPermissionsForUserHandler">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlers.go</code>:</p></div><table class="listing">
<tr><td>85</td><td><code><pre>func CheckPermissionsForUserHandler(request CheckPermissionRequest, r render.Render) {</pre></code></td></tr><tr><td>86</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>        err := CheckPermissionsForUser(request.UserId, Permission{PermissionDescription: request.PermissionDescription}, &amp;dbConnection)</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                ERROR.Println(&#34;Error checking for permission for userId: &#34; + strconv.FormatInt(request.UserId, 10) + &#34;, permission: &#34; + request.PermissionDescription)</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>                r.JSON(500, map[string]interface{}{&#34;permissionCheckResult&#34;: err.Error()})</pre></code></td></tr><tr><td>91</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>                r.JSON(200, map[string]interface{}{&#34;permissionCheckResult&#34;: nil})</pre></code></td></tr><tr><td>93</td><td><code><pre>        }</pre></code></td></tr><tr><td>94</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ValidateSessionTokenHandler">func ValidateSessionTokenHandler</div><div class="info"><a href="#s_fn_ValidateSessionTokenHandler">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlers.go</code>:</p></div><table class="listing">
<tr><td>72</td><td><code><pre>func ValidateSessionTokenHandler(request ValidateSessionTokenRequest, r render.Render) {</pre></code></td></tr><tr><td>73</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>        err, userId := ValidateSessionToken(request.SessionToken, &amp;dbConnection)</pre></code></td></tr><tr><td>75</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>76</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>                ERROR.Println(&#34;Error validating sessionToken: &#34; + request.SessionToken + &#34;, error:&#34; + err.Error())</pre></code></td></tr><tr class="miss"><td>78</td><td><code><pre>                r.JSON(500, map[string]interface{}{&#34;userId&#34;: userId, &#34;error&#34;: err.Error()})</pre></code></td></tr><tr><td>79</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>                r.JSON(200, map[string]interface{}{&#34;userId&#34;: userId, &#34;error&#34;: nil})</pre></code></td></tr><tr><td>81</td><td><code><pre>        }</pre></code></td></tr><tr><td>82</td><td><code><pre></pre></code></td></tr><tr><td>83</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ValidateUsernameHandler">func ValidateUsernameHandler</div><div class="info"><a href="#s_fn_ValidateUsernameHandler">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlers.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func ValidateUsernameHandler(usernameRequest ValidateUsernameRequest, r render.Render) {</pre></code></td></tr><tr><td>35</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>        validUsernameFlag := ValidateUniqueUsername(usernameRequest.Username, &amp;dbConnection)</pre></code></td></tr><tr><td>37</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>        r.JSON(200, map[string]interface{}{&#34;valid&#34;: validUsernameFlag})</pre></code></td></tr><tr><td>39</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Status">func Status</div><div class="info"><a href="#s_fn_Status">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlerUtils.go</code>:</p></div><table class="listing">
<tr><td>184</td><td><code><pre>func Status() string {</pre></code></td></tr><tr class="miss"><td>185</td><td><code><pre>        return &#34;alive at &#34; + time.Now().String()</pre></code></td></tr><tr><td>186</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_StatusHandler">func StatusHandler</div><div class="info"><a href="#s_fn_StatusHandler">Back</a><p>In <code>/Users/absharma/Desktop/code/gocode/src/gondalf/handlers.go</code>:</p></div><table class="listing">
<tr><td>10</td><td><code><pre>func StatusHandler(r render.Render) {</pre></code></td></tr><tr class="miss"><td>11</td><td><code><pre>        r.JSON(200, map[string]interface{}{&#34;status&#34;: Status()})</pre></code></td></tr><tr><td>12</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:gondalf DONE:58.15
-->

<div id="summaryWrapper"><div class="package">gondalf</div>
<div id="totalcov">58.15%</div>
</div>
    </body>
